
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Navigation with Spiri &mdash; Spiri Simulator 1.1.1 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Spiri Simulator 1.1.1 documentation" href="index.html" />
    <link rel="next" title="Perception with Spiri" href="perception.html" />
    <link rel="prev" title="Simulating Spiri" href="simulator.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="perception.html" title="Perception with Spiri"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="simulator.html" title="Simulating Spiri"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Spiri Simulator 1.1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="navigation-with-spiri">
<h1>Navigation with Spiri<a class="headerlink" href="#navigation-with-spiri" title="Permalink to this headline">¶</a></h1>
<p>Spiri comes with higher level robot functions which can be used as building
blocks when creating your robot application. One of these building blocks is
the Moveit navigation stack, which allows the robot to navigate from place to
place within the environment.</p>
<p>For more complete documentation of the individual components of the navigation
stack, see the documentation on the
<a class="reference external" href="http://moveit.ros.org/documentation/tutorials/">Moveit wiki</a>.</p>
<div class="section" id="starting-the-simulator-with-moveit">
<h2>Starting the Simulator with moveit<a class="headerlink" href="#starting-the-simulator-with-moveit" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>&gt;$ roslaunch spiri_description move_it_spiri.launch</pre>
</div>
<p>Run the controller which takes in a trajectory, calculates and sends velocity to Spiri.</p>
<div class="highlight-python"><pre>&gt;$ rosrun action_controller actioncontroller.py</pre>
</div>
<p>Wait for controllers and planning algorithms to come up. When you see the message &#8220;All is well! Everyone is happy! You can start planning now!&#8221; in move_it_spiri.launch terminal it means you can start sending goals.</p>
</div>
<div class="section" id="using-rviz-to-send-goals">
<h2>Using RVIZ to send goals<a class="headerlink" href="#using-rviz-to-send-goals" title="Permalink to this headline">¶</a></h2>
<p>Launch Rviz</p>
<div class="highlight-python"><pre>&gt;$ rosrun rviz rviz</pre>
</div>
<p>We can send goals using Moveit plugin for Rviz.</p>
<div class="align-centered figure align-center">
<img alt="_images/Rviz-spiri-goals.png" src="_images/Rviz-spiri-goals.png" style="width: 100%;" />
</div>
<p>Note that we have used <strong>PRMKConfig</strong> planner. In the drop down we have only included two planners as we have tested them with Spiri.</p>
<div class="align-centered figure align-center">
<img alt="_images/rviz-spiri-workspace.png" src="_images/rviz-spiri-workspace.png" style="width: 100%;" />
</div>
<p>Note that we have increase the <strong>workspace</strong> size. This is required for sending goals that are far.</p>
<p>You can set the goal state using interactive markers. After setting the goal state, press <strong>plan and execute</strong> and Spiri should move towards the goal state.</p>
<p>For more information refer to the link <a class="reference external" href="http://moveit.ros.org/wiki/PR2/Rviz_Plugin/Quick_Start">Goals using moveit</a>.</p>
</div>
<div class="section" id="using-api-to-send-goals">
<h2>Using API to send goals<a class="headerlink" href="#using-api-to-send-goals" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sending-commands-using-python">
<h3>Sending commands using Python<a class="headerlink" href="#sending-commands-using-python" title="Permalink to this headline">¶</a></h3>
<p>There are examples scripts located in <strong>examples</strong> folder. We have made it easy to send goals using our API.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">planner_request</span> <span class="kn">import</span> <span class="n">get_state</span>
<span class="c"># create an object for sending commands to Spiri</span>
<span class="n">spiri</span><span class="o">=</span><span class="n">get_state</span><span class="o">.</span><span class="n">Staterobot</span><span class="p">()</span>
<span class="c"># send goals with respect to start position</span>
<span class="n">spiri</span><span class="o">.</span><span class="n">send_goal_relative</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="c"># send goals with respect to world</span>
<span class="c">#spiri.send_goal(0,0,1)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reading-sensor-data">
<h2>Reading Sensor Data<a class="headerlink" href="#reading-sensor-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="using-ros">
<h3>Using ROS<a class="headerlink" href="#using-ros" title="Permalink to this headline">¶</a></h3>
<p>We have followed the ROS convention. All the sensor data are publised on ROS topics.</p>
<div class="highlight-python"><pre>&gt;$ rostopic list
&gt;$ rostopic echo /raw_imu</pre>
</div>
<p>For more information on <a class="reference external" href="http://wiki.ros.org/Topics">ROS topics</a>.</p>
</div>
<div class="section" id="using-api">
<h3>Using API<a class="headerlink" href="#using-api" title="Permalink to this headline">¶</a></h3>
<p>There are examples scripts located in <strong>examples</strong> folder. We have made it easy to read sensor data using our API.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">planner_request</span> <span class="kn">import</span> <span class="n">get_state</span>
<span class="c"># create an object to communicate with Spiri</span>
<span class="n">spiri</span><span class="o">=</span><span class="n">get_state</span><span class="o">.</span><span class="n">Staterobot</span><span class="p">()</span>
<span class="c"># get orientation from IMU in euler format</span>
<span class="n">imu</span><span class="o">=</span><span class="n">spiri</span><span class="o">.</span><span class="n">get_orientation_imu</span><span class="p">(</span><span class="s">&#39;euler&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Roll&#39;</span><span class="p">,</span><span class="n">imu</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="s">&#39;Pitch&#39;</span><span class="p">,</span><span class="n">imu</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;Yaw&#39;</span><span class="p">,</span><span class="n">imu</span><span class="o">.</span><span class="n">z</span>

<span class="c"># get orientation from IMU in Quaternion format</span>
<span class="n">imu</span><span class="o">=</span><span class="n">spiri</span><span class="o">.</span><span class="n">get_orientation_imu</span><span class="p">(</span><span class="s">&#39;quat&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">imu</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">imu</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">imu</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">imu</span><span class="o">.</span><span class="n">w</span>

<span class="c">#get GPS latitude, longitude and altitude</span>
<span class="n">gps</span><span class="o">=</span><span class="n">spiri</span><span class="o">.</span><span class="n">get_gps_data</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&#39;Latitude&#39;</span><span class="p">,</span><span class="n">gps</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span><span class="s">&#39;Longitude&#39;</span><span class="p">,</span><span class="n">gps</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span><span class="s">&#39;height&#39;</span><span class="p">,</span><span class="n">gps</span><span class="o">.</span><span class="n">altitude</span>

<span class="c">#get velocity from GPS</span>
<span class="n">gps_vel</span><span class="o">=</span><span class="n">spiri</span><span class="o">.</span><span class="n">get_gps_vel</span><span class="p">()</span>
<span class="k">print</span> <span class="n">gps_vel</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">gps_vel</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">gps_vel</span><span class="o">.</span><span class="n">z</span>
<span class="c"># get altitude from pressure sensor</span>
<span class="n">pressure_height</span><span class="o">=</span><span class="n">spiri</span><span class="o">.</span><span class="n">get_height_pressure</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&#39;height from pressure sensor is&#39;</span><span class="p">,</span><span class="n">pressure_height</span>

<span class="c"># get altitude from altimeter</span>
<span class="n">altimeter_height</span><span class="o">=</span><span class="n">spiri</span><span class="o">.</span><span class="n">get_height_altimeter</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&#39;height from altimeter is&#39;</span><span class="p">,</span><span class="n">altimeter_height</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Navigation with Spiri</a><ul>
<li><a class="reference internal" href="#starting-the-simulator-with-moveit">Starting the Simulator with moveit</a></li>
<li><a class="reference internal" href="#using-rviz-to-send-goals">Using RVIZ to send goals</a></li>
<li><a class="reference internal" href="#using-api-to-send-goals">Using API to send goals</a><ul>
<li><a class="reference internal" href="#sending-commands-using-python">Sending commands using Python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reading-sensor-data">Reading Sensor Data</a><ul>
<li><a class="reference internal" href="#using-ros">Using ROS</a></li>
<li><a class="reference internal" href="#using-api">Using API</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="simulator.html"
                        title="previous chapter">Simulating Spiri</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="perception.html"
                        title="next chapter">Perception with Spiri</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/navigation.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="perception.html" title="Perception with Spiri"
             >next</a> |</li>
        <li class="right" >
          <a href="simulator.html" title="Simulating Spiri"
             >previous</a> |</li>
        <li><a href="index.html">Spiri Simulator 1.1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Rohan Bhargava.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>